# 1.4 控制空间与邻域空间
## 控制空间(背景网格)
出于多种目的，引入 “控制空间” 的概念是很有用的，这一点将在关于自适应网格的章节中体现。实际上，该空间用于确定当前的背景网格。

为简化说明，理想的控制空间可简单定义为：在二维问题中，它是定义在\(\mathbb{R}^2\)内任意点\(P(x,y)\)处的函数\(H(x,y)\)。在其他工作中，函数\(H\)通过解析方式给出，用于指定空间中任意位置处网格单元必须遵循的**尺寸和方向特征**。然而，从实际应用角度看，控制空间并非完美理想的，因为上述函数\(H\)实际上仅以离散形式提供。形式上，控制空间可定义如下（[George-1991]）：

**定义 1.16** 若\((\Delta, H)\)满足以下条件，则它是给定域\(\Omega\)的网格\(T\)的控制空间：
- \(\Omega \subseteq \Delta\)，其中\(\Delta\)覆盖域\(\Omega\)；
- 对每个点\(P \in \Delta\)，关联一个函数\(H(P, \vec{d})\)，其中\(\vec{d}\)是圆面\(S^1\)（或三维空间中球面\(S^2\)）的方向：

| \(H(P, \vec{d}): \Delta \times S^1 \to \mathbb{R}\) |
| :--------: |

因此，控制空间包含两个相关要素。首先，定义覆盖三角剖分\(\Delta\)；其次，定义函数\(H\)，其支撑集为覆盖三角剖分\(\Delta\)。这一组合允许指定网格单元需遵循的某些属性或准则。

从几何角度看，\(\Delta\)是任意的覆盖三角剖分。例如，它可以是以下类型之一：
- 类型 1：规则剖分，如有限差分类型的剖分；
- 类型 2：基于四叉树或八叉树的剖分（见第 2 章和第 5 章）；
- 类型 3：任意用户构建的网格或当前网格，例如在迭代过程中，上一次计算的网格可作为背景网格。

除了剖分这一方面，\((\Delta, H)\)还通过函数\(H\)包含了与不同方面相关的全局信息。一方面可能是域的几何信息，另一方面可能是问题的物理信息。这些数值使我们能够确定正在构建的网格\(T\)是否在所有位置都符合该函数的要求。

为构建\(H\)，可考虑以下方法之一：
- 从数据中计算与给定点相关的局部步长\(h\)（\(h\)为两点间期望距离），再通过广义插值得到\(H\)。该过程纯粹是几何意义上的，因为它依赖于几何数据属性，如边界边长等；
- 为\(\Delta\)的每个单元手动定义\(H\)的值。对于各向同性控制，在空间各处给定期望尺寸；对于各向异性控制，按特定方向给定期望尺寸；
- 为专门构建的覆盖三角剖分的每个单元手动指定H的值（此处回到前文介绍的类型 3 空间）；
- 利用单元尺寸（如上述类型 2 的情况），该尺寸用于编码\(H\)的值，进而构建\((\Delta, H)\)空间以满足这一要求；
- 从后验误差估计中定义\(H\)。此时处于迭代自适应过程中：先构建网格\(T\)，计算对应解，通过误差估计分析该解以完善\(H\)；然后将\(\Delta\)设为\(T\)，数对\((T, H)\)构成控制空间，用于指导新网格的构建（参见第 21 章）。

对于每种不同类型，该定义会产生相应的控制空间类型。接下来，我们将展示如何根据该空间中包含的规范（针对网格构建方法）创建内部点，或如何优化网格（针对网格优化方法）。

**定义 1.17** 当点集\(P + H(P, \vec{d})\)的几何轨迹（其中\(P \in \Delta\)且\(\vec{d}\)会变化）为圆（三维情况下为球面）时，控制空间是各向同性的；当该轨迹为椭圆（三维情况下为椭球面）时，控制空间是各向异性的。

此后仅讨论这两种情况，进而定义用于指导网格构建过程的度量映射。

**注解 1.9** 在自适应网格构建过程中广泛使用的 “背景网格”（background mesh） 这一常见概念，本质上就是控制空间。此时，覆盖三角剖分是上一次迭代步骤的网格，而函数则由通过后验误差估计对当前解的分析得到。

**注解 1.10** 如后文所述，上述函数\(H\)与度量张量场密切相关。在此语境下，\(H(P, \vec{d})\)的离散意义可视为点\(P\)处的\(d \times d\)对称定矩阵，记为\(M(P)\)。

补充说明需注意，一些作者虽采用不同方法，但实际上也回归到了控制空间的这一概念。例如，可引入源点，利用这些信息来构建与上述 \(H\) 函数等价的量（[Löhner-1989]）。

## 邻域空间
与之前的控制空间概念相近的是**邻域空间**的概念。此类空间用于辅助处理相邻信息或查询。例如，它可用于便捷地搜索位于某些区域内的所有顶点，这类查询因多种用途而极具价值。

邻域空间的结构与控制空间类似，包含两个组成部分：空间支撑体以及与该支撑体相关的一些信息。空间支撑体可如前文所述进行定义，此时特别强调简单结构（如网格、树结构，例如二维的二叉树或四叉树），这类结构的局部化问题较为明显。除支撑体外，该空间还包含一些拓扑性质的信息。例如，对于网格，可在其单元中编码点、边等是否存在的信息。因此，当查询某一单元时，我们能知晓在特定邻域内是否存在点、边等。这是此类空间中可编码信息的一个简单示例。